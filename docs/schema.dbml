// SnowGoal - Data Model (SILVER Layer)
// Paste this into https://dbdiagram.io to visualize

Table COMPETITIONS {
  COMPETITION_CODE varchar [pk]
  COMPETITION_ID int
  COMPETITION_NAME varchar
  TYPE varchar
  EMBLEM varchar
  AREA_NAME varchar
  AREA_CODE varchar
  AREA_FLAG varchar
  CURRENT_SEASON_ID int
  SEASON_START date
  SEASON_END date
  CURRENT_MATCHDAY int
  _LOADED_AT timestamp
  _UPDATED_AT timestamp
}

Table TEAMS {
  TEAM_ID int [pk]
  COMPETITION_CODE varchar
  TEAM_NAME varchar
  TEAM_SHORT varchar
  TEAM_TLA varchar
  TEAM_CREST varchar
  ADDRESS varchar
  WEBSITE varchar
  FOUNDED int
  CLUB_COLORS varchar
  VENUE varchar
  COACH_ID int
  COACH_NAME varchar
  COACH_NATIONALITY varchar
  _LOADED_AT timestamp
  _UPDATED_AT timestamp
}

Table MATCHES {
  MATCH_ID int [pk]
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int
  MATCH_DATE timestamp
  STATUS varchar
  MATCHDAY int
  STAGE varchar
  HOME_TEAM_ID int [ref: > TEAMS.TEAM_ID]
  HOME_TEAM_NAME varchar
  HOME_TEAM_SHORT varchar
  HOME_TEAM_TLA varchar
  AWAY_TEAM_ID int [ref: > TEAMS.TEAM_ID]
  AWAY_TEAM_NAME varchar
  AWAY_TEAM_SHORT varchar
  AWAY_TEAM_TLA varchar
  HOME_SCORE int
  AWAY_SCORE int
  HOME_SCORE_HT int
  AWAY_SCORE_HT int
  WINNER varchar
  REFEREE_NAME varchar
  REFEREE_NATIONALITY varchar [note: 'NEW: Nationalité arbitre']
  REFEREE_ID int [note: 'NEW: ID arbitre']
  MATCH_DURATION varchar [note: 'NEW: REGULAR/EXTRA_TIME/PENALTY']
  AREA_NAME varchar [note: 'NEW: Nom du pays']
  AREA_CODE varchar [note: 'NEW: Code ISO pays']
  DAY_OF_WEEK varchar [note: 'NEW: Jour semaine (Mon-Sun)']
  MATCH_HOUR int [note: 'NEW: Heure match UTC (0-23)']
  CURRENT_MATCHDAY int [note: 'NEW: Journée compétition']
  LAST_UPDATED timestamp
  _LOADED_AT timestamp
  _UPDATED_AT timestamp
}

Table STANDINGS {
  TEAM_ID int [pk, ref: > TEAMS.TEAM_ID]
  COMPETITION_CODE varchar [pk, ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int [pk]
  POSITION int
  TEAM_NAME varchar
  TEAM_SHORT varchar
  TEAM_TLA varchar
  TEAM_CREST varchar
  PLAYED int
  WON int
  DRAW int
  LOST int
  POINTS int
  GOALS_FOR int
  GOALS_AGAINST int
  GOAL_DIFF int
  FORM varchar
  _LOADED_AT timestamp
  _UPDATED_AT timestamp
}

Table SCORERS {
  PLAYER_ID int [pk]
  COMPETITION_CODE varchar [pk, ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int [pk]
  PLAYER_NAME varchar
  FIRST_NAME varchar
  LAST_NAME varchar
  NATIONALITY varchar
  POSITION varchar
  DATE_OF_BIRTH date
  TEAM_ID int [ref: > TEAMS.TEAM_ID]
  TEAM_NAME varchar
  TEAM_SHORT varchar
  GOALS int
  ASSISTS int
  PENALTIES int
  PLAYED_MATCHES int
  _LOADED_AT timestamp
  _UPDATED_AT timestamp
}

// ============================================
// GOLD LAYER - Business Intelligence Tables
// ============================================

Table LEAGUE_STANDINGS {
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int
  POSITION int
  TEAM_ID int [ref: > TEAMS.TEAM_ID]
  TEAM_NAME varchar
  TEAM_TLA varchar
  TEAM_CREST varchar
  PLAYED int
  WON int
  DRAW int
  LOST int
  POINTS int
  GOALS_FOR int
  GOALS_AGAINST int
  GOAL_DIFF int
  FORM varchar
  POINTS_PER_GAME decimal
  GOALS_PER_GAME decimal
  GOALS_CONCEDED_PER_GAME decimal
  WIN_PERCENTAGE decimal

  Note: 'Classements avec métriques calculées'
}

Table TOP_SCORERS {
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int
  PLAYER_ID int
  PLAYER_NAME varchar
  NATIONALITY varchar
  POSITION varchar
  DATE_OF_BIRTH date
  AGE int
  TEAM_ID int [ref: > TEAMS.TEAM_ID]
  TEAM_NAME varchar
  TEAM_SHORT varchar
  GOALS int
  ASSISTS int
  PENALTIES int
  PLAYED_MATCHES int
  GOAL_CONTRIBUTIONS int
  GOALS_PER_MATCH decimal
  CONTRIBUTIONS_PER_MATCH decimal
  GOALS_RANK int
  CONTRIBUTIONS_RANK int

  Note: 'Top buteurs avec rankings et métriques'
}

Table TEAM_STATS {
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int
  TEAM_ID int [ref: > TEAMS.TEAM_ID]
  TEAM_NAME varchar
  HOME_PLAYED int
  HOME_WINS int
  HOME_DRAWS int
  HOME_LOSSES int
  HOME_GOALS_FOR int
  HOME_GOALS_AGAINST int
  AWAY_PLAYED int
  AWAY_WINS int
  AWAY_DRAWS int
  AWAY_LOSSES int
  AWAY_GOALS_FOR int
  AWAY_GOALS_AGAINST int
  TOTAL_PLAYED int
  TOTAL_WINS int
  TOTAL_GOALS_FOR int
  TOTAL_GOALS_AGAINST int
  HOME_PPG decimal
  AWAY_PPG decimal

  Note: 'Statistiques domicile/extérieur des équipes'
}

Table RECENT_MATCHES {
  MATCH_ID int [pk, ref: > MATCHES.MATCH_ID]
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int
  MATCH_DATE timestamp
  STATUS varchar
  MATCHDAY int
  STAGE varchar
  HOME_TEAM_ID int [ref: > TEAMS.TEAM_ID]
  HOME_TEAM_NAME varchar
  HOME_TEAM_TLA varchar
  AWAY_TEAM_ID int [ref: > TEAMS.TEAM_ID]
  AWAY_TEAM_NAME varchar
  AWAY_TEAM_TLA varchar
  HOME_SCORE int
  AWAY_SCORE int
  HOME_SCORE_HT int
  AWAY_SCORE_HT int
  WINNER varchar
  REFEREE_NAME varchar
  SCORE_DISPLAY varchar
  RESULT_DISPLAY varchar
  DAYS_AGO int

  Note: 'Matchs récents (30 derniers jours)'
}

Table UPCOMING_FIXTURES {
  MATCH_ID int [pk, ref: > MATCHES.MATCH_ID]
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  SEASON_YEAR int
  MATCH_DATE timestamp
  STATUS varchar
  MATCHDAY int
  HOME_TEAM_ID int [ref: > TEAMS.TEAM_ID]
  HOME_TEAM_NAME varchar
  HOME_TEAM_TLA varchar
  AWAY_TEAM_ID int [ref: > TEAMS.TEAM_ID]
  AWAY_TEAM_NAME varchar
  AWAY_TEAM_TLA varchar
  HOURS_UNTIL int
  DAYS_UNTIL int
  MATCH_DATETIME_DISPLAY varchar

  Note: 'Prochains matchs programmés'
}

// ============================================
// GOLD LAYER - Advanced Analytics Tables
// ============================================

Table MATCH_PATTERNS {
  COMPETITION_CODE varchar [ref: > COMPETITIONS.COMPETITION_CODE]
  DAY_OF_WEEK varchar
  MATCH_HOUR int
  TOTAL_MATCHES int
  AVG_TOTAL_GOALS decimal
  AVG_HOME_GOALS decimal
  AVG_AWAY_GOALS decimal
  EXTRA_TIME_MATCHES int
  HOME_WINS int
  AWAY_WINS int
  DRAWS int

  Note: 'Analyse temporelle des matchs (patterns par jour/heure)'
}

Table REFEREE_STATS {
  REFEREE_NAME varchar [note: 'Agrégé depuis MATCHES.REFEREE_NAME']
  REFEREE_NATIONALITY varchar [note: 'Agrégé depuis MATCHES.REFEREE_NATIONALITY']
  REFEREE_ID int [note: 'Agrégé depuis MATCHES.REFEREE_ID']
  MATCHES_REFEREED int
  COMPETITIONS int
  SEASONS int
  AVG_GOALS_PER_MATCH decimal
  EXTRA_TIME_MATCHES int
  EXTRA_TIME_PCT decimal

  Note: 'Statistiques des arbitres (agrégation depuis SILVER.MATCHES)'
}

Table GEOGRAPHIC_STATS {
  AREA_NAME varchar [note: 'Agrégé depuis MATCHES.AREA_NAME']
  AREA_CODE varchar [note: 'Agrégé depuis MATCHES.AREA_CODE']
  COMPETITIONS int
  TOTAL_MATCHES int
  AVG_GOALS_PER_MATCH decimal
  HOME_WINS int
  AWAY_WINS int
  DRAWS int
  HOME_WIN_PCT decimal

  Note: 'Analyse géographique par pays (agrégation depuis SILVER.MATCHES)'
}
