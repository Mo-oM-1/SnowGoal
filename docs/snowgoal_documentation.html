<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SnowGoal - Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #29B5E8;
            --secondary: #171B26;
            --accent: #7E57C2;
            --success: #4CAF50;
            --warning: #FF9800;
            --text: #333;
            --text-light: #666;
            --bg: #fff;
            --bg-light: #f8f9fa;
            --border: #e0e0e0;
        }

        @media print {
            body { font-size: 11pt; }
            .page-break { page-break-before: always; }
            .no-print { display: none; }
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background: var(--bg);
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(135deg, var(--secondary) 0%, #2d3748 100%);
            color: white;
            border-radius: 16px;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .badge-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .badge {
            background: var(--primary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
        }

        /* Sections */
        section {
            margin-bottom: 40px;
        }

        h2 {
            color: var(--secondary);
            border-bottom: 3px solid var(--primary);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        h3 {
            color: var(--accent);
            margin: 20px 0 10px;
            font-size: 1.3rem;
        }

        p {
            margin-bottom: 15px;
            color: var(--text-light);
        }

        /* Architecture Diagram */
        .architecture {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 30px;
            overflow-x: auto;
        }

        .architecture pre {
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre;
        }

        /* Feature Cards */
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .feature-card {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 25px;
            border-left: 4px solid var(--primary);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .feature-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .feature-card h4 {
            color: var(--secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .feature-card p {
            font-size: 0.95rem;
            margin: 0;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--secondary);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: var(--bg-light);
        }

        /* Code blocks */
        code {
            background: #e8e8e8;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 0.9em;
        }

        pre {
            background: var(--secondary);
            color: #e0e0e0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 15px 0;
        }

        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }

        /* Pipeline Flow */
        .pipeline-flow {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 30px 0;
        }

        .pipeline-step {
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
            min-width: 120px;
        }

        .pipeline-step .icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .pipeline-arrow {
            font-size: 1.5rem;
            color: var(--primary);
        }

        /* Leagues */
        .leagues-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .league-card {
            background: var(--bg-light);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid var(--border);
        }

        .league-card .flag {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }

            .pipeline-flow {
                flex-direction: column;
            }

            .pipeline-arrow {
                transform: rotate(90deg);
            }

            body {
                padding: 10px;
            }
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            margin-top: 40px;
            background: var(--bg-light);
            border-radius: 12px;
            color: var(--text-light);
        }

        /* TOC */
        .toc {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 40px;
        }

        .toc h3 {
            margin-top: 0;
            color: var(--secondary);
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc li {
            padding: 8px 0;
            border-bottom: 1px dashed var(--border);
        }

        .toc a {
            color: var(--primary);
            text-decoration: none;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        /* Highlight box */
        .highlight-box {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border-left: 4px solid var(--accent);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .highlight-box strong {
            color: var(--accent);
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="header">
        <h1>âš½ SnowGoal</h1>
        <p class="subtitle">Pipeline Analytics Football - 100% Snowflake Native</p>
        <div class="badge-container">
            <span class="badge">Snowflake</span>
            <span class="badge">Snowpark Python</span>
            <span class="badge">Dynamic Tables</span>
            <span class="badge">Streamlit</span>
            <span class="badge">Medallion Architecture</span>
        </div>
    </header>

    <!-- Table of Contents -->
    <nav class="toc">
        <h3>ğŸ“‘ Table des MatiÃ¨res</h3>
        <ul>
            <li><a href="#overview">1. Vue d'ensemble</a></li>
            <li><a href="#architecture">2. Architecture</a></li>
            <li><a href="#features">3. Features Snowflake</a></li>
            <li><a href="#data-model">4. ModÃ¨le de DonnÃ©es</a></li>
            <li><a href="#pipeline">5. Pipeline ETL</a></li>
            <li><a href="#deploy">6. Ordre de DÃ©ploiement</a></li>
            <li><a href="#dashboard">7. Dashboard Streamlit</a></li>
        </ul>
    </nav>

    <!-- Overview -->
    <section id="overview">
        <h2>1. Vue d'ensemble</h2>
        <p>
            <strong>SnowGoal</strong> est un pipeline de donnÃ©es analytics pour le football europÃ©en,
            construit entiÃ¨rement avec les fonctionnalitÃ©s natives de Snowflake. Le projet dÃ©montre
            l'utilisation de 15+ features Snowflake dans un cas d'usage rÃ©el.
        </p>

        <h3>ğŸ† Ligues Couvertes</h3>
        <div class="leagues-grid">
            <div class="league-card">
                <div class="flag">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿</div>
                <strong>Premier League</strong>
                <p>PL</p>
            </div>
            <div class="league-card">
                <div class="flag">ğŸ‡ªğŸ‡¸</div>
                <strong>La Liga</strong>
                <p>PD</p>
            </div>
            <div class="league-card">
                <div class="flag">ğŸ‡©ğŸ‡ª</div>
                <strong>Bundesliga</strong>
                <p>BL1</p>
            </div>
            <div class="league-card">
                <div class="flag">ğŸ‡®ğŸ‡¹</div>
                <strong>Serie A</strong>
                <p>SA</p>
            </div>
            <div class="league-card">
                <div class="flag">ğŸ‡«ğŸ‡·</div>
                <strong>Ligue 1</strong>
                <p>FL1</p>
            </div>
        </div>

        <div class="highlight-box">
            <strong>Source de donnÃ©es:</strong> football-data.org API (Free Tier)
            <br>
            <strong>Refresh:</strong> Automatique toutes les 6 heures via Tasks
        </div>
    </section>

    <!-- Architecture -->
    <section id="architecture" class="page-break">
        <h2>2. Architecture</h2>

        <h3>Pipeline Flow</h3>
        <div class="pipeline-flow">
            <div class="pipeline-step">
                <div class="icon">ğŸŒ</div>
                <div>API</div>
            </div>
            <span class="pipeline-arrow">â†’</span>
            <div class="pipeline-step">
                <div class="icon">ğŸ“¦</div>
                <div>RAW</div>
            </div>
            <span class="pipeline-arrow">â†’</span>
            <div class="pipeline-step">
                <div class="icon">ğŸ”„</div>
                <div>STAGING</div>
            </div>
            <span class="pipeline-arrow">â†’</span>
            <div class="pipeline-step">
                <div class="icon">ğŸ¥ˆ</div>
                <div>SILVER</div>
            </div>
            <span class="pipeline-arrow">â†’</span>
            <div class="pipeline-step">
                <div class="icon">ğŸ¥‡</div>
                <div>GOLD</div>
            </div>
            <span class="pipeline-arrow">â†’</span>
            <div class="pipeline-step">
                <div class="icon">ğŸ“Š</div>
                <div>Streamlit</div>
            </div>
        </div>

        <h3>Diagramme DÃ©taillÃ©</h3>
        <div class="architecture">
<pre>
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SNOWGOAL PIPELINE                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚  football-   â”‚     â”‚     RAW      â”‚     â”‚   STAGING    â”‚           â”‚
â”‚   â”‚  data.org    â”‚â”€â”€â”€â”€â–¶â”‚   (VARIANT)  â”‚â”€â”€â”€â”€â–¶â”‚   (Views)    â”‚           â”‚
â”‚   â”‚     API      â”‚     â”‚              â”‚     â”‚   FLATTEN    â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚          â”‚                    â”‚                    â”‚                    â”‚
â”‚          â”‚                    â”‚                    â–¼                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚  Snowpark   â”‚      â”‚  Streams  â”‚      â”‚    SILVER    â”‚            â”‚
â”‚   â”‚  Procedure  â”‚      â”‚   (CDC)   â”‚      â”‚   (MERGE)    â”‚            â”‚
â”‚   â”‚  + Secrets  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚                     â”‚
â”‚                                                  â–¼                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                    GOLD (Dynamic Tables)                         â”‚ â”‚
â”‚   â”‚  DT_STANDINGS â”‚ DT_SCORERS â”‚ DT_TEAM_STATS â”‚ DT_MATCHES         â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                                   â”‚
â”‚                                    â–¼                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚                    STREAMLIT IN SNOWFLAKE                        â”‚ â”‚
â”‚   â”‚         Dashboard interactif avec 4 pages                       â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                         TASKS (DAG)                             â”‚  â”‚
â”‚   â”‚     TASK_FETCH_ALL_LEAGUES â”€â”€â–¶ TASK_MERGE_TO_SILVER            â”‚  â”‚
â”‚   â”‚              (every 6h)              (auto)                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</pre>
        </div>
    </section>

    <!-- Features -->
    <section id="features" class="page-break">
        <h2>3. Features Snowflake UtilisÃ©es</h2>

        <div class="features-grid">
            <div class="feature-card">
                <h4>ğŸ“Š VARIANT Columns</h4>
                <p>Stockage JSON semi-structurÃ© pour les donnÃ©es API brutes sans schÃ©ma fixe.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ”„ Streams (CDC)</h4>
                <p>Capture des changements en temps rÃ©el sur les tables RAW pour le traitement incrÃ©mental.</p>
            </div>
            <div class="feature-card">
                <h4>âš¡ Dynamic Tables</h4>
                <p>RafraÃ®chissement automatique des agrÃ©gations sans orchestration externe.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ Snowpark Python</h4>
                <p>ProcÃ©dures stockÃ©es en Python pour l'appel API et transformation des donnÃ©es.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸŒ External Access</h4>
                <p>IntÃ©gration sÃ©curisÃ©e avec l'API externe football-data.org.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ” Secrets Management</h4>
                <p>Stockage sÃ©curisÃ© de la clÃ© API sans exposition dans le code.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“… Tasks & DAG</h4>
                <p>Orchestration native avec dÃ©pendances entre tÃ¢ches.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ”€ MERGE</h4>
                <p>Chargement incrÃ©mental avec upsert pour Ã©viter les doublons.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“ˆ Streamlit in Snowflake</h4>
                <p>Dashboard natif sans infrastructure externe.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ‘¥ RBAC</h4>
                <p>ContrÃ´le d'accÃ¨s par rÃ´les (Admin, Analyst, Viewer).</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ­ Masking Policies</h4>
                <p>Protection des donnÃ©es sensibles (ex: date de naissance).</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“ Internal Stages</h4>
                <p>Stockage des fichiers Python et Streamlit.</p>
            </div>
        </div>
    </section>

    <!-- Data Model -->
    <section id="data-model" class="page-break">
        <h2>4. ModÃ¨le de DonnÃ©es</h2>

        <h3>Schemas</h3>
        <table>
            <thead>
                <tr>
                    <th>Schema</th>
                    <th>Description</th>
                    <th>Objets</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>RAW</code></td>
                    <td>DonnÃ©es brutes JSON de l'API</td>
                    <td>RAW_MATCHES, RAW_TEAMS, RAW_STANDINGS, RAW_SCORERS, RAW_COMPETITIONS</td>
                </tr>
                <tr>
                    <td><code>STAGING</code></td>
                    <td>Views avec LATERAL FLATTEN</td>
                    <td>V_MATCHES, V_TEAMS, V_STANDINGS, V_SCORERS, V_COMPETITIONS</td>
                </tr>
                <tr>
                    <td><code>SILVER</code></td>
                    <td>Tables nettoyÃ©es et typÃ©es</td>
                    <td>MATCHES, TEAMS, STANDINGS, SCORERS, COMPETITIONS</td>
                </tr>
                <tr>
                    <td><code>GOLD</code></td>
                    <td>Dynamic Tables agrÃ©gÃ©es</td>
                    <td>DT_LEAGUE_STANDINGS, DT_TOP_SCORERS, DT_TEAM_STATS, DT_RECENT_MATCHES</td>
                </tr>
                <tr>
                    <td><code>COMMON</code></td>
                    <td>Objets partagÃ©s</td>
                    <td>Stages, Secrets, Procedures, Integrations</td>
                </tr>
            </tbody>
        </table>

        <h3>Tables Silver (Principales)</h3>
        <table>
            <thead>
                <tr>
                    <th>Table</th>
                    <th>Colonnes ClÃ©s</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>MATCHES</code></td>
                    <td>MATCH_ID, HOME_TEAM, AWAY_TEAM, SCORE, STATUS</td>
                    <td>Tous les matchs avec scores</td>
                </tr>
                <tr>
                    <td><code>STANDINGS</code></td>
                    <td>TEAM_ID, POSITION, POINTS, WON, DRAW, LOST</td>
                    <td>Classements par ligue</td>
                </tr>
                <tr>
                    <td><code>TEAMS</code></td>
                    <td>TEAM_ID, TEAM_NAME, VENUE, COACH_NAME</td>
                    <td>Informations Ã©quipes</td>
                </tr>
                <tr>
                    <td><code>SCORERS</code></td>
                    <td>PLAYER_ID, GOALS, ASSISTS, TEAM_NAME</td>
                    <td>Top buteurs</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Pipeline -->
    <section id="pipeline" class="page-break">
        <h2>5. Pipeline ETL</h2>

        <h3>Flux de DonnÃ©es</h3>
        <table>
            <thead>
                <tr>
                    <th>Ã‰tape</th>
                    <th>Source</th>
                    <th>Destination</th>
                    <th>MÃ©thode</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1. Extract</td>
                    <td>football-data.org API</td>
                    <td>RAW.RAW_*</td>
                    <td>Snowpark + External Access</td>
                </tr>
                <tr>
                    <td>2. Flatten</td>
                    <td>RAW.RAW_*</td>
                    <td>STAGING.V_*</td>
                    <td>Views + LATERAL FLATTEN</td>
                </tr>
                <tr>
                    <td>3. Transform</td>
                    <td>STAGING.V_*</td>
                    <td>SILVER.*</td>
                    <td>MERGE (incremental)</td>
                </tr>
                <tr>
                    <td>4. Aggregate</td>
                    <td>SILVER.*</td>
                    <td>GOLD.DT_*</td>
                    <td>Dynamic Tables (auto)</td>
                </tr>
            </tbody>
        </table>

        <h3>Orchestration (Tasks DAG)</h3>
        <pre><code>TASK_FETCH_ALL_LEAGUES (Schedule: every 6 hours)
    â”‚
    â”‚   Fetch PL â†’ PD â†’ BL1 â†’ SA â†’ FL1
    â”‚   (60s delay between each for rate limiting)
    â”‚
    â””â”€â”€â–¶ TASK_MERGE_TO_SILVER (After: TASK_FETCH_ALL_LEAGUES)
              â”‚
              â”‚   MERGE into SILVER tables
              â”‚
              â””â”€â”€â–¶ Dynamic Tables (Auto-refresh: 30min - 1h)</code></pre>
    </section>

    <!-- Deploy -->
    <section id="deploy" class="page-break">
        <h2>6. Ordre de DÃ©ploiement</h2>

        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Script</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td><code>00_init/01_database.sql</code></td>
                    <td>Database, Schemas, Warehouses</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td><code>00_init/02_file_formats.sql</code></td>
                    <td>JSON format, Stages</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td><code>01_raw/01_tables.sql</code></td>
                    <td>Tables RAW (VARIANT)</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td><code>01_raw/02_streams.sql</code></td>
                    <td>Streams CDC</td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>CrÃ©er Secret + Upload Python</td>
                    <td>FOOTBALL_API_KEY + fichiers .py</td>
                </tr>
                <tr>
                    <td>6</td>
                    <td><code>01_raw/03_stored_procedure.sql</code></td>
                    <td>Network Rule, Integration, Procedure</td>
                </tr>
                <tr>
                    <td>7</td>
                    <td><code>01_raw/04_fetch_all_procedure.sql</code></td>
                    <td>Procedure FETCH_ALL_LEAGUES</td>
                </tr>
                <tr>
                    <td>8</td>
                    <td><code>CALL FETCH_ALL_LEAGUES()</code></td>
                    <td>Chargement initial (~5 min)</td>
                </tr>
                <tr>
                    <td>9</td>
                    <td><code>02_staging/01_views.sql</code></td>
                    <td>Views FLATTEN</td>
                </tr>
                <tr>
                    <td>10</td>
                    <td><code>03_silver/01_tables.sql</code></td>
                    <td>Tables Silver</td>
                </tr>
                <tr>
                    <td>11</td>
                    <td><code>03_silver/02_merge.sql</code></td>
                    <td>MERGE RAW â†’ Silver</td>
                </tr>
                <tr>
                    <td>12</td>
                    <td><code>04_gold/01_dynamic_tables.sql</code></td>
                    <td>Dynamic Tables</td>
                </tr>
                <tr>
                    <td>13</td>
                    <td><code>05_tasks/01_tasks.sql</code></td>
                    <td>Tasks DAG</td>
                </tr>
                <tr>
                    <td>14</td>
                    <td><code>06_security/01_rbac.sql</code></td>
                    <td>RBAC + Masking</td>
                </tr>
                <tr>
                    <td>15</td>
                    <td>Upload Streamlit + <code>07_streamlit/01_deploy_app.sql</code></td>
                    <td>Dashboard</td>
                </tr>
            </tbody>
        </table>
    </section>

    <!-- Dashboard -->
    <section id="dashboard">
        <h2>7. Dashboard Streamlit</h2>

        <h3>Pages</h3>
        <div class="features-grid">
            <div class="feature-card">
                <h4>ğŸ  Home</h4>
                <p>Vue d'ensemble avec stats live (Matches, Teams, Scorers, Leagues).</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ† Standings</h4>
                <p>Classements par ligue avec KPIs et graphiques.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ¯ Top Scorers</h4>
                <p>Podium des meilleurs buteurs avec stats dÃ©taillÃ©es.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸ“… Matches</h4>
                <p>RÃ©sultats rÃ©cents et prochains matchs.</p>
            </div>
            <div class="feature-card">
                <h4>ğŸŸï¸ Teams</h4>
                <p>DÃ©tails Ã©quipes avec stats Home/Away.</p>
            </div>
        </div>

        <h3>AccÃ¨s</h3>
        <p>
            Le dashboard est accessible via <strong>Streamlit in Snowflake</strong> :
            <br>
            Snowsight â†’ Streamlit â†’ SNOWGOAL_DASHBOARD
        </p>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p><strong>SnowGoal</strong> - Football Analytics Pipeline</p>
        <p>Built 100% on Snowflake Native Features</p>
        <p style="margin-top: 15px; font-size: 0.9rem;">
            Data Source: football-data.org | Architecture: Medallion (RAW â†’ SILVER â†’ GOLD)
        </p>
    </footer>

</body>
</html>
